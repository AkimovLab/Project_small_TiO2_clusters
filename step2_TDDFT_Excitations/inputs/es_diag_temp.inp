&GLOBAL
   PRINT_LEVEL  MEDIUM
   PROJECT_NAME TiO2_01_300K
   RUN_TYPE  ENERGY
&END GLOBAL
&FORCE_EVAL
  METHOD  QS
  &PROPERTIES
    &TDDFPT
       NSTATES     10             # number of excited states
       MAX_ITER    200           # maximum number of Davidson iterations
       CONVERGENCE [eV] 1.0e-5   # convergence on maximum energy change between iterations
       NLUMO 25

       !RESTART     .TRUE.
       !WFN_RESTART_FILE_NAME RESTART.tdwfn

    &END TDDFPT
  &END PROPERTIES
  &DFT
    UKS .FALSE.
    BASIS_SET_FILE_NAME EMSL_BASIS_SETS
    BASIS_SET_FILE_NAME BASIS_MOLOPT_UZH
    POTENTIAL_FILE_NAME POTENTIAL_UZH
    &QS
      METHOD GPW
      EPS_DEFAULT 1.000E-12
    &END QS
    &POISSON
      PERIODIC NONE
      PSOLVER MT
    &END
    &SCF
      &DIAGONALIZATION ON
      &END DIAGONALIZATION
      &MIXING
        ALPHA 0.3
        METHOD BROYDEN_MIXING
        NBROYDEN 8
      &END MIXING
      EPS_SCF 1.0E-6
      SCF_GUESS RESTART
      MAX_SCF  1500
      ADDED_MOS 50
    &END SCF
    &XC
      &XC_FUNCTIONAL
        &HYB_GGA_XC_CAM_B3LYP
          _AC 0.81
          _ALPHA 0.65
          _BETA -0.46
          _OMEGA 0.33
        &END HYB_GGA_XC_CAM_B3LYP
      &END XC_FUNCTIONAL
      &HF
        &INTERACTION_POTENTIAL
          POTENTIAL_TYPE MIX_CL_TRUNC
          CUTOFF_RADIUS 5.0
          OMEGA 0.33
          SCALE_COULOMB 0.19
          SCALE_LONGRANGE 0.46
          T_C_G_DATA t_c_g.dat
        &END
        &SCREENING
          EPS_SCHWARZ 1.0E-12
        &END
        &MEMORY
        ! This is the maximum memory for each processor in MBi, I just comment it but
        ! you can obtain it through computing the memory you ask in the slurm file
        ! divided by the number of processors.
          MAX_MEMORY  10000
          EPS_STORAGE_SCALING 0.1
        &END MEMORY
        FRACTION 1.0
      &END
      ! In CP2K versions lower than v7, this part is required for TDDFT calculations
      &XC_GRID
        XC_DERIV SPLINE2_SMOOTH
      &END XC_GRID
      &VDW_POTENTIAL
         POTENTIAL_TYPE PAIR_POTENTIAL
         &PAIR_POTENTIAL
            PARAMETER_FILE_NAME dftd3.dat
            TYPE DFTD3
            REFERENCE_FUNCTIONAL PBE
            R_CUTOFF [angstrom] 5.0
         &END
      &END VDW_POTENTIAL
    &END XC
    &PRINT
      &MULLIKEN OFF
      &END
      &HIRSHFELD OFF
      &END
      &MO ON
        FILENAME tio2
        EIGENVECTORS F
        EIGENVALUES F
        NDIGITS 8
      &END
      &PDOS
        APPEND T
        COMPONENTS T
        FILENAME tio2
      &END
      &MO_MOLDEN ON
        FILENAME
        NDIGITS 8
        GTO_KIND SPHERICAL
      &END
    &END PRINT
  &END DFT
  &SUBSYS

    &CELL
      A         10.000000000         0.0000000000         0.0000000000
      B         0.0000000000        10.000000000         0.0000000000
      C         0.0000000000         0.0000000000        10.000000000
      PERIODIC  NONE
    &END CELL

    &TOPOLOGY
      COORD_FILE_NAME TiO2_unit_cell.xyz
      COORD_FILE_FORMAT XYZ
      &CENTER_COORDINATES T
      &END
      ! Only in case you use cif file
      !&GENERATE
      !  REORDER T
      !&END
    &END

    &KIND  Ti
      BASIS_SET DZVP-MOLOPT-PBE0-GTH-q12
      POTENTIAL GTH-PBE0-q12
    &END KIND
    &KIND O
      BASIS_SET DZVP-MOLOPT-PBE0-GTH-q6
      POTENTIAL GTH-PBE0-q6
    &END KIND
  &END SUBSYS
&END FORCE_EVAL
